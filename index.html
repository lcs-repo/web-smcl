<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>SAMPANA MEDICLINIC AND LABORATORY</title>
        <style>
            :root {
                --primary-color: #da291c;
                --secondary-color: #e74c3c;
                --accent-color: #e97c70;
                --background-color: #f4f4f4;
                --text-color: #333;
            }

            body {
                font-family: 'Helvetica', sans-serif;
                line-height: 1.6;
                margin: 0;
                padding: 0;
                background-color: var(--background-color);
                color: var(--text-color);
            }

            header {
                background-color: var(--primary-color);
                padding: 1rem;
                text-align: center;
                margin-bottom: 0;
            }

            .logo-container {
                display: flex;
                flex-direction: column;
                align-items: center;
                text-align: center;
                margin-bottom: 1rem;
            }

            .logo {
                max-width: 700px;
                width: 100%;
                height: auto;
            }

            .building {
                max-width: 450px;
                width: 100%;
                height: auto;
            }

            .tagline {
                color: #fff;
                font-style: italic;
                margin-top: 0.5rem;
                margin-bottom: 0;
            }

            .home {
                align-items: center;
            }

            nav {
                background-color: var(--secondary-color);
                padding: 1rem;
            }

            nav ul {
                list-style-type: none;
                padding: 0;
                margin: 0;
                display: flex;
                justify-content: center;
                flex-wrap: wrap;
            }

            nav ul li {
                margin: 0 15px;
            }

            nav ul li a {
                color: #fff;
                text-decoration: none;
                font-weight: bold;
                transition: color 0.3s ease;
            }

            nav ul li a:hover {
                color: var(--accent-color);
            }

            nav ul li a:active,
            nav ul li a:focus,
            nav ul li a:visited {
                color: #fff;
            }

            main {
                max-width: 1200px;
                margin: 2rem auto;
                padding: 0 1rem;
            }

            section {
                background-color: #fff;
                border-radius: 8px;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                padding: 2rem;
                margin-bottom: 2rem;
            }

            h2 {
                color: var(--primary-color);
                border-bottom: 2px solid var(--accent-color);
                padding-bottom: 0.5rem;
            }

            .cta-button {
                display: inline-block;
                background-color: var(--primary-color);
                color: #fff;
                padding: 12px 24px;
                text-decoration: none;
                border-radius: 5px;
                font-weight: bold;
                transition: background-color 0.3s ease;
            }

            .cta-button:hover {
                background-color: #c0392b;
            }

            footer {
                background-color: var(--secondary-color);
                color: #fff;
                text-align: center;
                padding: 1rem;
                margin-top: 2rem;
            }

            @media (max-width: 768px) {
                .logo {
                    max-width: 450px;
                }
                .building {
                    max-width: 450px;
                }
                nav ul li a:focus {
                    outline: none;
                }
            }

            #chat-widget {
                position: fixed;
                bottom: 20px;
                right: 20px;
                width: 300px;
                height: 400px;
                border-radius: 15px;
                background-color: white;
                border: 1px solid #ccc;
                transition: all 0.3s ease;
                z-index: 1000;
                box-shadow: 0 0 10px rgba(0,0,0,0.1);
                display: flex;
                flex-direction: column;
                max-width: calc(100% - 40px);
            }

            #chat-widget.minimized {
                width: 100px;
                height: 100px !important;
                border-radius: 50%;
                overflow: hidden;
                bottom: 20px;
                right: 20px;
            }

            #chat-header {
                border-top-left-radius: 15px;
                border-top-right-radius: 15px;
                background-color: var(--primary-color);
                color: rgb(255, 255, 255);
                padding: 10px;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: space-between;
            }
            #chat-body {
                display: flex;
                flex-direction: column;
                flex-grow: 1;
                overflow-y: auto;
                overflow-x: hidden;
            }

            .chat-icon {
                display: none;
                width: 100px;
                height: 85px;
                background-image: url('assets/images/chatus.png');
                background-size: cover;
                background-position: center;
            }

            #chat-widget.minimized .chat-icon {
                display: block;
            }
            #chat-widget.minimized #chat-body,
            #chat-widget.minimized .chat-title {
                display: none;
            }

            #chat-messages {
                display: flex;
                flex-direction: column;
                padding: 10px;
            }

            #chat-input {
               display: flex; 
               padding: 10px;
               box-sizing: border-box;
            }

            .message {
                max-width: 70%;
                margin-bottom: 10px;
                padding: 8px 12px;
                border-radius: 18px;
                line-height: 1.4;
            }

            .user-message {
                align-self: flex-end;
                background-color: var(--primary-color);
                color: white;
            }

            .support-message {
                align-self: flex-start;
                background-color: #e0e0e0;
                color: black;
            }

            .chat-input-field {
                flex-grow: 1;
                margin-right: 10px;
                padding: 10px;
                font-size: 16px;
                border: 1px solid #ccc;
                border-radius: 20px;
                max-width: calc(100% - 100px);
            }

            .chat-send-button {
                padding: 10px 20px;
                font-size: 16px;
                background-color: var(--primary-color);
                color: white;
                border: none;
                border-radius: 20px;
                cursor: pointer;
                transition: background-color 0.3s ease;
                white-space: nowrap;
            }

            .chat-send-button:hover {
                background-color: #c0392b
            }

            html, body {
                overflow-x: hidden;
            }
        </style>
    </head>
    <body>
        <header>
            <div class="logo-container">
                <img src="assets/images/7.png" alt="Sampana Mediclinic Logo" class="logo" />
                <p class="tagline">Committed to Caring since 2000.</p>
            </div>
        </header>
        <nav>
            <ul>
                <li><a href="#home">Home</a></li>
                <li><a href="#services">Services</a></li>
                <li><a href="#about">About Us</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
        </nav>
        <main>
            <section id="home">
                <h2>Welcome to Sampana Mediclinic</h2>
                <p>Sampana Mediclinic is committed to providing high-quality medical care with advanced diagnostic facilities.
                    Our team of experienced doctors and staff are dedicated to your health and well-being.</p>
                <a href="#contact" class="cta-button">Book an Appointment</a>
            </section>
            <section id="services">
                <h2>Our Services</h2>
                <ul>
                    <li>General Checkup</li>
                    <li>Clinical Laboratory</li>
                    <li>X-ray</li>
                    <li>Ultrasound</li>
                    <li>2D-Echo</li>
                    <li>ECG</li>
                </ul>
            </section>
            <section id="about">
                <h2>Location / Operating Hours</h2>
                <p>South Supermarket Parking - McArthur Highway, Bulihan, Malolos Bulacan</p>
                <p>Monday - Saturday</p>
                <p>6:00 AM - 5:00 PM</p>
            </section>
            <section id="photo-album">
                <h2>Our Facility</h2>
                <div id="slideshow" style="position: relative; max-width: 450px; margin: 0 auto;">
                    <img id="slideshow-img" src="assets/images/B.JPG" alt="Facility Image" style="width: 100%; height: auto;">
                    <button onClick="prevSlide()" style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%);">&#10094;</button>
                    <button onClick="nextSlide()" style="position: absolute; right: 10px; top: 50%; transform: translate(-50%);">&#10095;</button>
                </div>
            </section>
            <section id="contact">
                <h2>Contact Us / Book an Appointment</h2>
                <p><strong>Phone:</strong> 09627522727 / 09671934111</p>
                <p><strong>Facebook:</strong> Sampana Mediclinic and Laboratory</p>
                <p><strong>Email:</strong> smcl.malolos@gmail.com</p>
                <p><strong>Address:</strong> South Supermarket Parking - McArthur Highway, Bulihan, Malolos Bulacan</p>
            </section>
        </main>
        <footer>
            <p>&copy; 2024 Sampana Mediclinic and Laboratory. All rights reserved.</p>
        </footer>
        <div id="chat-widget" class="minimized">
            <div id="chat-header">
                <span class="chat-title">Chat with us</span>
                <span class="chat-icon"></span>
            </div>
            <div id="chat-body">
                <div id="chat-messages" style="flex-grow: 1; overflow-y: auto; padding: 10px;"></div>
                <div id="chat-input" style="display: flex; padding: 10px">
                    <input type="text" id="user-message" class="chat-input-field" placeholder="Type message here">
                    <button onclick="sendMessage()" class="chat-send-button">Send</button>
            </div>
        </div>
    </body>

    <script>
        // IMAGE SLIDER FUNCTIONALITY
        let currentSlide = 0;
        const slides = [
            'assets/images/B.jpg',
            'assets/images/B2.jpg',
            'assets/images/B3.jpg',
            'assets/images/R1.jpg',
            'assets/images/R2.jpg',
            'assets/images/R3.jpg',
            'assets/images/R4.jpg',
            'assets/images/R5.jpg',
            'assets/images/R6.jpg',
            'assets/images/R7.jpg',
            'assets/images/R8.jpg',
            'assets/images/R9.jpg',
            'assets/images/D.jpg',
            'assets/images/E.jpg'
        ];
        
        // Updates the src attribute based on the index handed over by nextSlide()/prevS
        function showSlide(index) {
            const img = document.getElementById('slideshow-img');
            img.src = slides[index];
        }

        // Clicked Next button, then calculates the index and hands it over to showSlide()
        function nextSlide() {
            currentSlide = (currentSlide + 1) % slides.length;
            showSlide(currentSlide);
        }

        // Clicked Previous button, then Calculates the index and hands it over to showSlide()
        function prevSlide() {
            currentSlide = (currentSlide - 1 + slides.length) % slides.length;
            showSlide(currentSlide);
        }
        
        // Mobile UI, swipe feature for image slideshow
        document.addEventListener('DOMContentLoaded', () => {
            const slideshow = document.getElementById('slideshow');
            let startX;

            slideshow.addEventListener('touchstart', (e) => {
                startX = e.touches[0].clientX;
            });

            slideshow.addEventListener('touchend', (e) => {
                const endX = e.changedTouches[0].clientX;
                if (startX - endX > 50) {
                    nextSlide();
                } else if (endX - startX > 50) {
                    prevSlide();
                }
            });
        })

        // CHAT WIDGET FUNCTIONALITY
        // Dom Element Selection through getting the each id
        const chatWidget = document.getElementById('chat-widget');
        const chatHeader = document.getElementById('chat-header');
        const chatMessages = document.getElementById('chat-messages');
        const userMessageInput = document.getElementById('user-message');

        // Toggle Chat Widget Visibility
        chatHeader.addEventListener('click', () => {
            chatWidget.classList.toggle('minimized');
        });

        // 
        function sendMessage() {
            // Gets the message from user and trims it
            const message = userMessageInput.value.trim();
            
            if (message) {
                addMessage('User', message);
                userMessageInput.value = '';
                
                // Check if this is the first message
                if (chatMessages.children.length === 1) {
                    setTimeout(() => {
                        addMessage('Support', 'Thank you for your message po. Pwede po ba malaman ang pangalan at contact number po?');
                    }, 1000);
                // If exactly three stacks, the following message will be added to the stack
                } else if (chatMessages.children.length === 3 ) {
                    setTimeout(() => {
                        addMessage('Support', 'Automated message po ito, kapag po walang nagreply sa loob ng 2 mins. Magreply nalang po kami ng kasagutan sa number po ninyo. May karagdagang katanungan pa po sila?');
                    }, 1000);
                    setTimeout(() => {
                        addMessage('Support', 'Ang SAMPANA MEDICLINIC MALOLOS po ay mayroong Clinical Laboratory, Xray, Ultrasound, 2D-Echo, ECG, at mga Doctors na maaaring magcheckup po sa inyo.  Kami po ay bukas mula 6AM-5PM (Monday-Saturday). Nandito lang po kami sa loob ng parking ng South Supermarket Malolos. May gusto po ba silang itanong?');
                    }, 1000);
                // More than 3 stacks, the following message will be the default
                } else {
                    // Default response for subsequent messages
                    setTimeout(() => {
                        addMessage('Support', 'Automated message po ito, kapag po walang nagreply sa loob ng 2 mins. Magreply nalang po kami ng kasagutan sa number po ninyo. May karagdagang katanungan pa po sila?');
                    }, 1000);
                }
            }
        }

        // Add message stack based on the input of the 
        // The input of sender is either User or Support with their respective texts
        function addMessage(sender, text) {
            const messageElement = document.createElement('div');
            messageElement.classList.add('message');
            messageElement.classList.add(sender.toLowerCase() + '-message');
            messageElement.textContent = text;
            chatMessages.appendChild(messageElement);
            chatMessages.scrollTop = chatMessages.scrollHeight;

            // Save message to server
            saveMessageToServer(sender, text);
        }

        // This function always listen if there is an Enter keypress which will trigger sendMessage()
        userMessageInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage()
            }
        });

        // ARCHIVING CHATS FUNCTIONALITY
        // Session ID generation: Creates a unique session id for each chat session
        function generateSessionId() {
            return 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        let sessionId = sessionStorage.getItem('chatSessionId');
        if (!sessionId) {
            sessionId = generateSessionId();
            sessionStorage.setItem('chatSessionId', sessionId);
        }

        // A function to send chat message data to a server-side script for storage
        function saveMessageToServer(sender, message) {
            fetch('save_chat.php', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `sessionId=${encodeURIComponent(sessionId)}&sender=${encodeURIComponent(sender)}&message=${encodeURIComponent(message)}`
            })
            .then(response => response.text())
            .then(data => console.log(data))
            .catch((error) => console.error('Error:', error));
        }
    </script>
</html>